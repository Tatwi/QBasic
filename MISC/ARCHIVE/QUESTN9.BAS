REM ROB BASSETT
REM QUESTION NINE

COLOR 7, 1, 2

DO
  CLS
  PRINT : PRINT
  PRINT : PRINT TAB(10); "1        ENTER DATA"
  PRINT : PRINT TAB(10); "2        PRINT DATA"
  PRINT : PRINT TAB(10); "3        PRINT TO PRINTER"
  PRINT : PRINT TAB(10); "4        SORT DATA"
  PRINT : PRINT TAB(10); "5        READ DATA FROM DISK"
  PRINT : PRINT TAB(10); "6        PRINT DATA TO DISK"
  PRINT : PRINT TAB(10); "7        START NEW DATA FILE"
  PRINT : PRINT TAB(10); "Q        QUIT"

  DO
    A$ = INKEY$
  LOOP WHILE A$ = ""

  IF A$ = "Q" OR A$ = "q" THEN EXIT DO
  ON VAL(A$) GOSUB ENTER, PRINTDATA, PRINTTOPRINTER, SORT, READDISK, PRINTDISK, STARTNEW
 
  LOOP
  END



PRINTDISK:
  CLS
  INPUT "WHAT IS DATA DRIVE"; D$
  INPUT "WHAT IS DATA DIRECTORY"; DIR$
  INPUT "WHAT IS FILE NAME"; F$
  DATA$ = D$ + DIR$ + F$
  OPEN DATA$ FOR OUTPUT AS #1

  FOR X = 1 TO NR
     PRINT #1, N$(X)
     PRINT #1, A(X)
     PRINT #1, N(X)
     PRINT #1, T$(X)
     PRINT #1, C$(X)
  NEXT X
  CLOSE #1
RETURN

STARTNEW:
  NR = 0
RETURN

ENTER:
  CLS
  PRINT "EOF IS XXX"
  PRINT
  DO
    NR = NR + 1
    INPUT "ENTER NAME"; N$(NR)
    IF N$(NR) = "XXX" THEN EXIT DO
    INPUT "ENTER AGE"; A(NR)
    INPUT "ENTER YOUR FAVORITE NUMBER"; N(NR)
    INPUT "ENTER YOUR TOWN"; T$(NR)
    INPUT "ENTER YOUR FAVORITE COLOUR"; C$(NR)
  LOOP
  NR = NR - 1
RETURN


SORT:
  CLS
  PRINT "ONE MOMENT PLEASE.    SORTING"
  FOR Y = 1 TO NR - 1
     F = 0
     FOR X = 1 TO NR - Y
        IF N$(X) > N$(X + 1) THEN
          SWAP N$(X), N$(X + 1)
          SWAP A(X), A(X + 1)
          SWAP N(X), N(X + 1)
          SWAP T$(X), T$(X + 1)
          SWAP C$(X), C$(X + 1)
          F = 1
        END IF
     NEXT X
     IF F = 0 THEN EXIT FOR
  NEXT Y
F = 0
RETURN


PAUSE:
  PRINT : PRINT "PRESS ANY KEY TO CONTINUE"
  DO
  LOOP WHILE INKEY$ = ""
RETURN

PRINTDATA:
  CLS
  PRINT "NAMES", "AGE", "FAVE NUM.", "TOWN ", "FAVE COLOUR"
  FOR X = 1 TO NR
     PRINT N$(X), A(X), N(X), T$(X), C$(X)
  NEXT X
  GOSUB PAUSE
RETURN

READDISK:
  CLS
  INPUT "WHAT IS DATA DRIVE"; D$
  INPUT "WHAT IS DATA DIRECTORY"; DIR$
  INPUT "WHAT IS FILE NAME"; F$
  DATA$ = D$ + DIR$ + F$
  OPEN DATA$ FOR INPUT AS #1
  DO WHILE NOT EOF(1)
    INPUT #1, N$(NR), A(NR), N(NR), T$(NR), C$(NR)
    NR = NR + 1
  LOOP
  CLOSE #1
RETURN

PRINTTOPRINTER:
 OPEN "LPT1" FOR OUTPUT AS #1
   PRINT #1, "NAME", "AGE", "FAVE NUM. ", "TOWN ", " FAVE COLOUR "
   FOR X = 1 TO NR
      PRINT #1, N$(X), A(X), N(X), T$(X), C$(X)
   NEXT X
 CLOSE #1
RETURN


