REM ROB BASSETT
REM QUESTION EIGHT

COLOR 7, 1, 2

DO
  CLS
  PRINT : PRINT
  PRINT : PRINT TAB(10); "1        ENTER DATA"
  PRINT : PRINT TAB(10); "2        PRINT DATA"
  PRINT : PRINT TAB(10); "4        SORT DATA"
  PRINT : PRINT TAB(10); "5        READ DATA FROM DISK"
  PRINT : PRINT TAB(10); "6        PRINT DATA TO DISK"
  PRINT : PRINT TAB(10); "7        START NEW DATA FILE"
  PRINT : PRINT TAB(10); "Q        QUIT"

  DO
    A$ = INKEY$
  LOOP WHILE A$ = ""

  IF A$ = "Q" OR A$ = "q" THEN EXIT DO
  ON VAL(A$) GOSUB ENTER, PRINTDATA, SORT, READDISK, PRINTDISK, STARTNEW
LOOP
END

PRINTDISK:
  INPUT "WHAT IS DATA DRIVE"; D$
  INPUT "WHAT IS DATA DIRECTORY"; DIR$
  INPUT "WHAT IS FILE NAME"; F$
  DATA$ = D$ + DIR$ + F$
  OPEN DATA$ FOR OUTPUT AS #1

  FOR X = 1 TO NR
     PRINT #1, N$(X), A(X)
  NEXT X
  CLOSE #1
RETURN

STARTNEW:
  NR = 0
RETURN

ENTER:
  CLS
  PRINT "EOF IS XXX"
  PRINT
  DO
    NR = NR + 1
    INPUT "ENTER NAME"; N$(NR)
    INPUT "ENTER AGE"; A(X)
    IF N$(NR) = "XXX" THEN EXIT DO

  LOOP
  NR = NR - 1
RETURN


SORT:
  CLS
  PRINT "ONE MOMENT PLEASE.    SORTING"
  FOR Y = 1 TO NR - 1
     F = 0
     FOR X = 1 TO NR - Y
        IF N$(X) > N$(X + 1) THEN
          SWAP N$(X), N$(X + 1)
          SWAP A(X), A(X + 1)
          F = 1
        END IF
     NEXT X
     IF F = 0 THEN EXIT FOR
  NEXT Y
F = 0
RETURN


PAUSE:
  PRINT : PRINT "PRESS ANY KEY TO CONTINUE"
  DO
  LOOP WHILE INKEY$ = ""
RETURN

PRINTDATA:
  CLS
  PRINT "NAMES", "AGE"
  FOR X = 1 TO NR
     PRINT N$(X), A(X)
  NEXT X
  GOSUB PAUSE
RETURN

READDISK:
  CLS
  INPUT "WHAT IS DATA DRIVE"; D$
  INPUT "WHAT IS DATA DIRECTORY"; DIR$
  INPUT "WHAT IS FILE NAME"; F$
  DATA$ = D$ + DIR$ + F$
  OPEN DATA$ FOR INPUT AS #1
  DO WHILE NOT EOF(1)
    NR = NR + 1
    INPUT #1, N$(NR)
    INPUT #1, A(X)
  LOOP
  CLOSE #1
RETURN



